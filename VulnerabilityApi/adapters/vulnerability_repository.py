from abc import ABC, abstractmethod
from typing import List, Optional

from VulnerabilityApi.models.models import Vulnerability


class VulnerabilityRepository(ABC):
    @abstractmethod
    def get_by_cve(self, cve: str) -> Optional[Vulnerability]:
        pass

    @abstractmethod
    def get_all(self, title: Optional[str], min_criticality: Optional[int], max_criticality: Optional[int]) -> List[Vulnerability]:
        pass

    @abstractmethod
    def create(self, vulnerability: Vulnerability) -> Vulnerability:
        pass

    @abstractmethod
    def delete(self, cve: str) -> Optional[Vulnerability]:
        pass
