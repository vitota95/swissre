import re

from pydantic import BaseModel, Field, field_validator


class Vulnerability(BaseModel):
    title: str = Field(..., max_length=30)
    cve: str
    criticality: int = Field(..., ge=0, le=10)
    description: str = Field(..., max_length=100)

    @field_validator("cve")
    @classmethod
    def validate_cve(cls, value):
        if not re.match(r"CVE-\d{4}-\d{4,7}", value):
            raise ValueError(
                "CVE must match the pattern CVE-YYYY-NNNN or CVE-YYYY-NNNNNNN"
            )
        return value
